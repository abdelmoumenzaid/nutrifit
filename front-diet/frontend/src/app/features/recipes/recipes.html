<div class="recipes-container">
  <!-- üîç Search bar -->
  <div class="search-container">
    <input
      type="text"
      class="search-input"
      placeholder="üîç Chercher une recette..."
      [(ngModel)]="search"
      (keyup.enter)="onSearch()"
      [disabled]="loading"
    />
    <button
      class="search-btn"
      (click)="onSearch()"
      [disabled]="loading"
    >
      {{ loading ? 'Chargement...' : 'Chercher' }}
    </button>
  </div>

  <!-- ü§ñ AI Prompt section -->
  <div class="ai-section">
    <h3>‚ú® G√©n√©rer une recette avec l'IA</h3>
    <div class="ai-input-group">
      <input
        type="text"
        class="ai-input"
        placeholder="ex: recette poulet √©pic√© rapide"
        [(ngModel)]="aiPrompt"
        [disabled]="aiLoading"
      />
      <button
        class="ai-btn"
        (click)="generateAIRecipe()"
        [disabled]="aiLoading"
      >
        {{ aiLoading ? 'G√©n√©ration...' : 'G√©n√©rer' }}
      </button>
    </div>
  </div>

  <!-- üè∑Ô∏è Filters -->
  <div class="filters">
    <!-- Chips filtr√©es -->
    <button
      class="filter-chip"
      [class.active]="activeFilter === 'all'"
      (click)="setFilter('all')"
    >
      Tout
    </button>
    <button
      class="filter-chip"
      [class.active]="activeFilter === 'breakfast'"
      (click)="setFilter('breakfast')"
    >
      Petit-d√©j
    </button>
    <button
      class="filter-chip"
      [class.active]="activeFilter === 'lunch'"
      (click)="setFilter('lunch')"
    >
      D√©jeuner
    </button>
    <button
      class="filter-chip"
      [class.active]="activeFilter === 'dinner'"
      (click)="setFilter('dinner')"
    >
      D√Æner
    </button>
    <button
      class="filter-chip"
      [class.active]="activeFilter === 'snack'"
      (click)="setFilter('snack')"
    >
      Collation
    </button>

    <!-- More filters -->
    <button class="filter-chip more-btn" (click)="toggleMoreFilters()">
      + Plus de filtres
    </button>
  </div>

  <!-- üìÇ More filters panel -->
  <div class="more-filters-panel" *ngIf="showMoreFilters">
    <h3>Cat√©gories</h3>
    <div class="category-list">
      <button
        *ngFor="let category of categories"
        class="category-btn"
        [class.selected]="selectedCategory === category"
        (click)="applyCategoryFilter(category)"
      >
        {{ category }}
      </button>
    </div>
  </div>

  <!-- üìã Recipes grid -->
  <div class="recipes-grid">
    <div
      class="recipe-card"
      *ngFor="let recipe of recipes"
      (click)="openRecipe(recipe)"
    >
      <div *ngIf="recipe.source === 'AI'" class="ai-badge">AI</div>
      <img [src]="recipe.image" [alt]="recipe.name" class="card-image" />
      <div class="card-body">
        <h3>{{ recipe.name }}</h3>
        <p class="desc">{{ recipe.description | slice : 0 : 100 }}...</p>
        <div class="meta">
          <span class="pill">{{ recipe.calories }} kcal</span>
          <span class="pill">{{ recipe.time }} min</span>
          <span class="pill">{{ recipe.difficulty }}</span>
        </div>
        <button
          class="link"
          (click)="openRecipe(recipe); $event.stopPropagation()"
        >
          Voir la recette
        </button>
      </div>
    </div>
  </div>

  <!-- üìç Loading state -->
  <div class="loading-state" *ngIf="loading && page === 0">
    <p>‚è≥ Chargement des recettes...</p>
  </div>

  <!-- ‚úÖ Show more button -->
  <div class="show-more-container" *ngIf="hasMore && !loading && recipes.length > 0">
    <button class="show-more-btn" (click)="showMore()">
      Afficher plus de recettes
    </button>
  </div>

  <!-- üö´ No results message -->
  <div class="no-results" *ngIf="!loading && recipes.length === 0">
    <p>Aucune recette trouv√©e... Essaie une autre recherche ! üîç</p>
  </div>
</div>