server {
    listen 80;                    # Écoute sur le port 80
    server_name _;                # Accepte tous les domaines

    root /usr/share/nginx/html;   # Racine des fichiers (app Angular compilée)
    index index.html;             # Fichier par défaut

    # ============================================
    # Angular routing + fallback
    # ============================================
    location / {
        # Si le fichier/dossier existe → le servir
        # Sinon → servir index.html (routing client Angular)
        try_files $uri $uri/ /index.html;
    }

    # ============================================
    # Gestion des erreurs 404 / 5xx
    # ============================================
    error_page 404 /index.html;              # 404 → index.html
    error_page 500 502 503 504 /index.html;  # 5xx → index.html

    # La directive "internal" empêche l'accès direct à index.html
    location = /index.html {
        internal;
    }

    # ============================================
    # Cache des assets statiques (JS, CSS, images)
    # ============================================
    location /assets/ {
        expires 1y;                           # Cache 1 an
        add_header Cache-Control "public";    # Laisse les navigateurs cacher
    }
}
